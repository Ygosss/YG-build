/* [UPDATED] styles.zip/styles/main.css */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;500;700&display=swap'); /* MOVED TO TOP */

/* src/styles/main.css */
/* --- GLOBAL SETUP & THEME V4.1 (2025 Refined Palettes) --- */

/* --- [REMASTERED] Modernized Light Theme (Royal Blue) --- */
:root {
    --font-family: 'Noto Sans Thai', sans-serif;
    --border-radius-sm: 8px;
    --border-radius-md: 12px;
    --border-radius-lg: 16px;
    --border-radius-xl: 28px;
    --transition-speed: 0.3s;

    /* Main Palette */
    --primary: #4A69E2; /* A more vibrant, professional Royal Blue */
    --on-primary: #FFFFFF;
    --primary-container: #DDE2FF;
    --on-primary-container: #001B3F;
    --secondary: #5A5D72; /* A neutral, complementary grey */
    --on-secondary: #FFFFFF;

    /* Status Colors (Refined) */
    --danger: #BA1A1A;
    --on-danger: #FFFFFF;
    --danger-container: #FFDAD6;
    --on-danger-container: #410002;
    --warning: #8C5300; /* Refined to a richer Amber */
    --warning-container: #FFDDBA;
    --on-warning-container: #2D1700;
    --success: #006E1C;
    --success-container: #93F992;
    --on-success-container: #002204;
    --info: #00658E;
    --info-container: #C8E6FF;
    --on-info-container: #001E2E;

    /* Surface & Background */
    --background: #FEFBFF; /* Clean, bright white */
    --surface: #F8F9FC; /* Surface for cards, slightly off-white */
    --surface-container: #F3F4F7; /* Slightly darker for nested elements */
    --surface-container-high: #EAEFF9;
    --on-surface: #191A1D; /* Primary text color (MODIFIED FOR CLARITY) */
    --on-surface-variant: #43444D; /* Secondary text, icons (MODIFIED FOR CLARITY) */

    /* Outlines & Shadows */
    --outline: #DDE2E7;
    --outline-variant: #C5C6D0;
    --shadow-color: rgba(74, 105, 226, 0.1);
    --glow-color: rgba(74, 105, 226, 0.15);
    --shadow-sm: 0 2px 4px var(--shadow-color);
    --shadow-md: 0 4px 15px var(--shadow-color), 0 2px 20px var(--glow-color);
    --shadow-lg: 0 10px 25px var(--shadow-color), 0 5px 30px var(--glow-color);
    --glass-bg: rgba(248, 249, 252, 0.9); /* Kept for header/footer */
    --glass-border: rgba(255, 255, 255, 0.6); /* Kept for header/footer */

    /* --- [NEW] Item Type Colors --- */
    --curtain-color: #E57399; /* Rose Pink */
    --curtain-container-color: hsl(340, 70%, 97%);
    --wallpaper-color: #4CAF50; /* Evergreen */
    --wallpaper-container-color: hsl(122, 39%, 97%);
    --wooden-blind-color: #8D6E63; /* Mocha */
    --wooden-blind-container-color: hsl(19, 15%, 97%);
    --roller-blind-color: #9C27B0; /* Royal Purple */
    --roller-blind-container-color: hsl(291, 64%, 97%);
    --vertical-blind-color: #FF5722; /* Hermes Orange */
    --vertical-blind-container-color: hsl(14, 100%, 97%);
    --partition-color: #03A9F4; /* Sky Blue */
    --partition-container-color: hsl(200, 90%, 97%);
    --pleated-screen-color: #009688; /* Teal */
    --pleated-screen-container-color: hsl(174, 100%, 97%);
    --aluminum-blind-color: #BDBDBD; /* Silver */
    --aluminum-blind-container-color: hsl(0, 0%, 97%);
}

/* --- [REMASTERED] Refined Dark Theme --- */
body.dark-theme {
    /* Main Palette */
    --primary: #B0C9FF; /* Slightly brighter for better contrast */
    --on-primary: #153062;
    --primary-container: #314D7B;
    --on-primary-container: #D9E2FF;
    --secondary: #BEC6DC;
    --on-secondary: #2B3141;

    /* Status Colors (Refined) */
    --danger: #FFB4AB;
    --on-danger: #690005;
    --danger-container: #93000A;
    --on-danger-container: #FFDAD6;
    --warning: #FFB868; /* Refined to a warmer Amber */
    --on-warning: #4B2A00;
    --warning-container: #6A3E00;
    --on-warning-container: #FFDDBA;
    --success: #77DC79;
    --success-container: #005312;
    --on-success-container: #93F992;
    --info: #8BCEFF;
    --info-container: #004C6C;
    --on-info-container: #C8E6FF;

    /* Surface & Background */
    --background: #1B1B1F; /* Base background */
    --surface: #202125; /* Card background */
    --surface-container: #2A2B30; /* Nested element background */
    --surface-container-high: #35363B;
    --on-surface: #E8E9EC; /* Primary text (MODIFIED FOR CLARITY) */
    --on-surface-variant: #C8CAD0; /* Secondary text (MODIFIED FOR CLARITY) */

    /* Outlines & Shadows */
    --outline: #45464F;
    --outline-variant: #8F909A;
    --shadow-color: rgba(0, 0, 0, 0.3);
    --glow-color: rgba(176, 201, 255, 0.1);
    --glass-bg: rgba(27, 27, 31, 0.85); /* Kept for header/footer */
    --glass-border: rgba(69, 70, 79, 0.5); /* Kept for header/footer */

    /* --- [NEW] Item Type Colors (Dark) --- */
    --curtain-color: #F4A9BC;
    --curtain-container-color: #5C3742;
    --wallpaper-color: #8BC34A;
    --wallpaper-container-color: #385939;
    --wooden-blind-color: #BCAAA4;
    --wooden-blind-container-color: #4E403A;
    --roller-blind-color: #BA68C8;
    --roller-blind-container-color: #4F2658;
    --vertical-blind-color: #FF8A65;
    --vertical-blind-container-color: #662E1C;
    --partition-color: #4FC3F7;
    --partition-container-color: #1A5069;
    --pleated-screen-color: #4DB6AC;
    --pleated-screen-container-color: #194C47;
    --aluminum-blind-color: #EEEEEE;
    --aluminum-blind-container-color: #595959;
}

/* --- [REMASTERED] Modern Monochrome Slate Theme --- */
body.neutral-theme {
    /* Main Palette (Monochrome) */
    --primary: #F0F2F5; /* Primary "color" is light grey/white for high contrast */
    --on-primary: #1A1D20;
    --primary-container: #414850;
    --on-primary-container: #F0F2F5;
    --secondary: #ADB5BD; /* Muted grey for secondary elements */
    --on-secondary: #212529;

    /* Status Colors (Refined for Readability) */
    --danger: #FFB4AB;
    --on-danger: #690005;
    --danger-container: #93000A;
    --on-danger-container: #FFDAD6;
    --warning: #FFB868; /* Refined to Amber */
    --warning-container: #6A3E00;
    --on-warning-container: #FFDDBA; /* [FIXED] Light text for contrast */
    --success: #77DC79;
    --success-container: #005312;
    --on-success-container: #93F992; /* [FIXED] Light text for contrast */
    --info: #8BCEFF;
    --info-container: #004C6C;
    --on-info-container: #C8E6FF; /* [FIXED] Light text for contrast */

    /* Surface & Background */
    --background: #212529; /* Dark Slate background */
    --surface: #343A40; /* Lighter Slate for cards */
    --surface-container: #1a1d20; /* Almost Black */
    --surface-container-high: #414850;
    --on-surface: #F5F7FA; /* Light Off-White text (MODIFIED FOR CLARITY) */
    --on-surface-variant: #BFC5CB; /* Muted Gray for subtext (MODIFIED FOR CLARITY) */

    /* Outlines & Shadows */
    --outline: #5A6169;
    --outline-variant: #868E96;
    --shadow-color: rgba(0, 0, 0, 0.4);
    --glow-color: rgba(240, 242, 245, 0.05);
    --glass-bg: rgba(52, 58, 64, 0.85); /* Kept for header/footer */
    --glass-border: rgba(90, 97, 105, 0.5); /* Kept for header/footer */

    /* --- [NEW] Item Type Colors (Neutral) --- */
    --curtain-color: #E5A9B4;
    --curtain-container-color: #5C3742;
    --wallpaper-color: #A5D6A7;
    --wallpaper-container-color: #385939;
    /* ACCESSIBILITY FIX: Increased contrast for wooden blind text */
    --wooden-blind-color: #CFC3BC;
    --wooden-blind-container-color: #4E403A;
    --roller-blind-color: #CE93D8;
    --roller-blind-container-color: #4F2658;
    --vertical-blind-color: #FFAB91;
    --vertical-blind-container-color: #662E1C;
    --partition-color: #81D4FA;
    --partition-container-color: #1A5069;
    --pleated-screen-color: #80CBC4;
    --pleated-screen-container-color: #194C47;
    --aluminum-blind-color: #E0E0E0;
    --aluminum-blind-container-color: #595959;
}


* { box-sizing: border-box; margin: 0; padding: 0; }
html {
    scroll-behavior: smooth;
}
/* [REMOVED] Scroll snap */
body {
    font-family: var(--font-family);
    font-weight: 400; /* UPDATED FOR CLARITY */
    background-color: var(--background);
    color: var(--on-surface);
    margin: 0;
    padding-bottom: 100px;
    transition: background-color var(--transition-speed), color var(--transition-speed);
    line-height: 1.6; /* ADDED FOR READABILITY */
}
h1, h2, h3, h4 { color: var(--on-surface); font-weight: 700; transition: color var(--transition-speed); line-height: 1.3; } /* Added line-height */
i.ph { font-size: 1.25em; vertical-align: middle; }
#app-container { max-width: 800px; margin: 0 auto; padding: 1rem; }
.main-header {
    background: var(--glass-bg);
    backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
    border-bottom: 1px solid var(--glass-border);
    padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center;
    position: sticky; top: 0; z-index: 100;
    border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
    margin: 0 auto 1rem; max-width: 824px; width: calc(100% - 8px);
    box-shadow: var(--shadow-md), inset 0 1px 1px var(--glass-border);
    transition: background-color var(--transition-speed), border-color var(--transition-speed), box-shadow var(--transition-speed);
}
.header-title-group { display: flex; align-items: center; gap: 0.75rem; min-width: 0; }
.main-header h1 { font-size: 1.25rem; color: var(--primary); white-space: nowrap; }
.header-actions { display: flex; align-items: center; gap: 0.5rem; }

.card {
    background-color: var(--surface);
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--outline);
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-md);
    overflow: visible; /* [MODIFIED] Allow overflow for menu */
    transition: all var(--transition-speed) ease-in-out;
    position: relative;
    /* [REMOVED] scroll-snap-align: start; */
    scroll-margin-top: 80px;
}

@media (hover: hover) {
    .card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); border-color: var(--primary); }
}

.room-card.is-suspended {
    opacity: 0.6;
    filter: grayscale(80%);
}
.item-card.is-suspended {
    opacity: 0.5;
    filter: grayscale(80%);
    background-image: repeating-linear-gradient(-45deg, transparent, transparent 5px, rgba(120, 120, 120, 0.1) 5px, rgba(120, 120, 120, 0.1) 10px);
}

.card summary {
    list-style: none; display: flex; justify-content: space-between; align-items: center;
    padding: 0.75rem 0.5rem 0.75rem 1.25rem; cursor: pointer; background-color: transparent; gap: 0.5rem;
}
.card summary::-webkit-details-marker { display: none; }
.card .expand-icon { transition: transform var(--transition-speed) ease; font-size: 1.5rem; color: var(--on-surface-variant); }
.card[open] > summary .expand-icon { transform: rotate(180deg); }
.card summary h2 { font-size: 1.2rem; letter-spacing: 0.5px; display: flex; align-items: center; gap: 0.75rem; flex-grow: 1; margin:0; }
.card-content {
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    overflow: visible; /* [MODIFIED] Allow overflow for menu */
}

/* --- [REDESIGNED] Room Header & Actions --- */
.room-header-controls {
    display: flex;
    gap: 0.5rem;
    align-items: flex-start;
    position: relative; /* [MODIFIED] Needed for menu positioning */
    z-index: 1; /* [MODIFIED] Ensure controls are above items */
}
.room-header-controls .form-group {
    flex-grow: 1;
    margin: 0;
}
/* [MODIFIED] Make container a flexbox */
.room-options-container {
    padding-top: 0.1rem; /* Align button better with input */
    display: flex; /* [NEW] */
    gap: 0.25rem; /* [NEW] */
}
/* [NEW] Style for the new room defaults button */
.room-header-controls .btn-icon[data-act="open-room-defaults"] {
    color: var(--primary);
}
.room-header-controls .btn-icon[data-act="open-room-defaults"]:hover {
    background-color: var(--primary-container);
}

.room-name-input {
    font-size: 1.1rem;
    font-weight: 700;
    padding: 0.65rem 0.75rem;
    background-color: var(--surface);
    border: 2px solid var(--outline);
}
.room-name-input::placeholder {
    color: var(--on-surface-variant);
    font-weight: 500;
}
.room-name-input:focus {
    background-color: var(--surface);
    border-color: var(--primary);
    box-shadow: 0 0 0 3px var(--primary-container);
}
.room-actions-footer {
    padding-top: 0.75rem;
    margin-top: 0.75rem;
    border-top: 1px solid var(--outline);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.5rem;
}
.room-actions-footer .btn, .room-actions-footer .btn-chip {
    padding: 0.6rem 1.2rem;
    font-size: 0.9rem;
}
.room-ender {
    height: 1px;
    background: var(--outline);
    margin: 0.25rem 0.75rem 0.75rem;
}
.room-summary-controls {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    flex-shrink: 0;
}
.room-brief {
    font-size: 0.875rem;
    color: var(--on-surface-variant);
    text-align: right;
    white-space: nowrap;
    padding: 0 0.5rem;
}
/* [MODIFIED] Position relative for menu */
.room-options-container .room-options-menu {
    position: absolute; top: calc(100% + 4px); right: 0;
    background-color: var(--surface); /* [MODIFIED] Opaque background */
    border-radius: var(--border-radius-md); box-shadow: var(--shadow-lg); border: 1px solid var(--outline); /* [MODIFIED] Solid border */
    display: flex; flex-direction: column; width: max-content;
    opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all var(--transition-speed) ease;
    z-index: 120; /* Increased z-index */
    overflow: hidden; /* [MODIFIED] Added overflow hidden for consistency */
}
.room-options-menu.show { opacity: 1; visibility: visible; transform: translateY(0); }
.room-options-menu a { padding: 0.75rem 1.25rem; text-decoration: none; color: var(--on-surface); display: flex; align-items: center; gap: 0.75rem; font-size: 0.9rem; }
.room-options-menu a:hover { background-color: var(--surface-container); }
.room-options-menu a.danger { color: var(--danger); }
.room-options-menu a.danger:hover { background-color: var(--danger-container); }
/* [ADDED] Style for hr in menu */
.room-options-menu hr {
    border: none;
    border-top: 1px solid var(--outline);
    margin: 0.25rem 0;
}

.items-container { display: flex; flex-direction: column; gap: 0.75rem; }
.item-card {
    border: 1px solid var(--outline); background-color: var(--surface); border-radius: var(--border-radius-md);
    border-left: 5px solid var(--outline-variant); transition: all var(--transition-speed); overflow: hidden;
    box-shadow: 0 3px 10px rgba(0,0,0,0.07); border-top: 3px solid transparent;
    scroll-margin-top: 100px;
}
.item-header { display: flex; justify-content: space-between; align-items: center; padding: 0.6rem 0.75rem; transition: background-color var(--transition-speed); }
.item-title { display: flex; align-items: center; gap: 0.5rem; font-size: 1rem; font-weight: 700; color: var(--on-surface-variant); transition: color var(--transition-speed); }
.item-title > span { font-weight: 700; }
.item-type-display { font-weight: normal; }

/* --- [REFACTORED] Item Type Specific Styles --- */
.set-item { border-left-color: var(--curtain-color); border-top-color: var(--curtain-color); }
.set-item .item-title, .set-item .item-type-display { color: var(--curtain-color); }
.set-item .item-header { background-color: var(--curtain-container-color); border-bottom: 1px solid var(--outline); }

.wallpaper-item { border-left-color: var(--wallpaper-color); border-top-color: var(--wallpaper-color); }
.wallpaper-item .item-title, .wallpaper-item .item-type-display { color: var(--wallpaper-color); }
.wallpaper-item .item-header { background-color: var(--wallpaper-container-color); border-bottom: 1px solid var(--outline); }

.wooden-blind-item { border-left-color: var(--wooden-blind-color); border-top-color: var(--wooden-blind-color); }
.wooden-blind-item .item-title, .wooden-blind-item .item-type-display { color: var(--wooden-blind-color); }
.wooden-blind-item .item-header { background-color: var(--wooden-blind-container-color); border-bottom: 1px solid var(--outline); }

.roller-blind-item { border-left-color: var(--roller-blind-color); border-top-color: var(--roller-blind-color); }
.roller-blind-item .item-title, .roller-blind-item .item-type-display { color: var(--roller-blind-color); }
.roller-blind-item .item-header { background-color: var(--roller-blind-container-color); border-bottom: 1px solid var(--outline); }

.vertical-blind-item { border-left-color: var(--vertical-blind-color); border-top-color: var(--vertical-blind-color); }
.vertical-blind-item .item-title, .vertical-blind-item .item-type-display { color: var(--vertical-blind-color); }
.vertical-blind-item .item-header { background-color: var(--vertical-blind-container-color); border-bottom: 1px solid var(--outline); }

.partition-item { border-left-color: var(--partition-color); border-top-color: var(--partition-color); }
.partition-item .item-title, .partition-item .item-type-display { color: var(--partition-color); }
.partition-item .item-header { background-color: var(--partition-container-color); border-bottom: 1px solid var(--outline); }

.pleated-screen-item { border-left-color: var(--pleated-screen-color); border-top-color: var(--pleated-screen-color); }
.pleated-screen-item .item-title, .pleated-screen-item .item-type-display { color: var(--pleated-screen-color); }
.pleated-screen-item .item-header { background-color: var(--pleated-screen-container-color); border-bottom: 1px solid var(--outline); }

.aluminum-blind-item { border-left-color: var(--aluminum-blind-color); border-top-color: var(--aluminum-blind-color); }
.aluminum-blind-item .item-title, .aluminum-blind-item .item-type-display { color: var(--aluminum-blind-color); }
.aluminum-blind-item .item-header { background-color: var(--aluminum-blind-container-color); border-bottom: 1px solid var(--outline); }


.item-actions { display: flex; align-items: center; gap: 0.25rem; }
.item-grid, .walls-section { padding: 0.5rem; }
.item-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; }
.item-summary { background-color: var(--surface-container); padding: 0.75rem; font-size: 0.9rem; color: var(--on-surface-variant); border-top: 1px solid var(--outline); margin: 0.5rem 0 0 0; transition: background-color var(--transition-speed), border-color var(--transition-speed); }
.item-summary.single-line { text-align: center; }
.item-summary b { color: var(--on-surface); font-weight: 700; }
.walls-section { margin-top: 0; padding-top: 0.75rem; border-top: 1px solid var(--outline-variant); }
.walls-section > p { display: block; margin-bottom: 0.5rem; font-weight: 500; }
.walls-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 0.4rem; margin-bottom: 0.5rem; }
.wall-input-row { display: flex; align-items: center; gap: 0.25rem; }
.form-grid-2 { display: grid; grid-template-columns: 1fr; gap: 1rem; }
@media (min-width: 300px) { .form-grid-2 { grid-template-columns: 1fr 1fr; gap: 0.75rem; } }
.form-group { display: flex; flex-direction: column; position: relative; }
.form-group.full-width-item { grid-column: 1 / -1; }
.form-group label, legend { font-size: 0.875rem; color: var(--on-surface-variant); margin-bottom: 0.25rem; padding-left: 0.5rem; font-weight: 500; display: flex; flex-direction: column; gap: 0.35rem; padding-left: 0; }
.form-group label > input, .form-group label > select, .form-group label > textarea { margin-top: 0; }
legend {
    padding-inline: 2px;
}
input[type="text"], input[type="tel"], input[type="number"], input[type="password"], textarea, select {
    width: 100%; padding: 0.65rem 0.75rem; border-radius: var(--border-radius-md); border: 1px solid var(--outline);
    background-color: var(--surface-container); color: var(--on-surface); font-family: var(--font-family);
    font-size: 1rem; font-weight: 400; /* UPDATED FOR CLARITY */
    transition: border-color var(--transition-speed), box-shadow var(--transition-speed), background-color var(--transition-speed);
}
input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-container); background-color: var(--surface); }
input:disabled, select:disabled, textarea:disabled {
    background-color: var(--surface-container-high);
    color: var(--on-surface);
    border-color: var(--outline);
    cursor: not-allowed;
    opacity: 1;
    font-weight: 700;
    -webkit-text-fill-color: var(--on-surface);
    box-shadow: none;
}
select:disabled { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding-right: 0.75rem; }
textarea { resize: vertical; }
input[inputmode="numeric"] { text-align: left; }
.btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: var(--border-radius-xl); border: none; font-family: var(--font-family); font-size: 1rem; font-weight: 700; cursor: pointer; transition: all var(--transition-speed); -webkit-tap-highlight-color: transparent; }
.btn:active { transform: scale(0.97); }
.btn:disabled {
    background-color: var(--surface-container-high);
    color: var(--outline-variant);
    cursor: not-allowed;
    box-shadow: none;
    filter: none;
}
.btn.btn-primary { background-color: var(--primary); color: var(--on-primary); }
.btn.btn-primary:hover { filter: brightness(1.1); box-shadow: var(--shadow-sm); }
.btn.btn-secondary { background-color: var(--primary-container); color: var(--on-primary-container); }
.btn.btn-secondary:hover { filter: brightness(0.97); }
.btn.btn-danger { background-color: var(--danger); color: var(--on-danger); }
.btn.btn-danger:hover { filter: brightness(1.1); box-shadow: var(--shadow-sm); }
.btn-icon { background: none; border: none; border-radius: 50%; width: 44px; height: 44px; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; color: var(--on-surface-variant); transition: background-color var(--transition-speed), color var(--transition-speed); }
.btn-icon:hover { background-color: var(--surface-container-high); color: var(--primary); }
.btn-icon.danger:hover { background-color: var(--danger-container); color: var(--danger); }
.btn-icon-small { width: 32px; height: 32px; }
.btn-icon-small .ph { font-size: 1rem; }
.btn-chip { background-color: var(--surface); color: var(--on-surface-variant); padding: 0.5rem 1rem; border-radius: var(--border-radius-sm); border: 1px solid var(--outline); font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: all var(--transition-speed); }
.btn-chip:hover { background-color: var(--surface-container-high); border-color: var(--outline-variant); }
.btn-chip.btn-curtain { color: var(--curtain-color); }
.btn-chip.btn-curtain:hover { background-color: var(--curtain-container-color); border-color: var(--curtain-color); }
.header-btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; background: none; border: none; border-radius: 50%; width: 44px; height: 44px; color: var(--on-surface-variant); cursor: pointer; transition: all var(--transition-speed); }
.header-btn:hover { background-color: var(--surface-container-high); color: var(--primary); }
.header-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    background-color: transparent;
    color: var(--outline-variant);
}
.header-btn:disabled:hover {
    background-color: transparent;
    color: var(--outline-variant);
}
.visually-hidden {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
}

/* --- [MODIFIED] Item Type Changer Button --- */
.item-type-changer {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    background-color: var(--surface-container);
    color: var(--on-surface-variant);
    padding: 0.4rem 0.8rem;
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--outline);
    font-size: 0.95em;
    font-weight: 500;
    font-family: var(--font-family);
    cursor: pointer;
    transition: all var(--transition-speed);
    vertical-align: middle;
}
.item-type-changer:hover {
    background-color: var(--surface-container-high);
    border-color: var(--primary);
    color: var(--primary);
}
.item-type-changer .ph-caret-down { font-size: 0.8em; }
.set-item .item-type-changer,
.wallpaper-item .item-type-changer,
.area-based-item .item-type-changer {
    color: inherit;
}
.set-item .item-type-changer:hover { background-color: var(--curtain-container-color); border-color: var(--curtain-color); }
.wallpaper-item .item-type-changer:hover { background-color: var(--wallpaper-container-color); border-color: var(--wallpaper-color); }
.wooden-blind-item .item-type-changer:hover { background-color: var(--wooden-blind-container-color); border-color: var(--wooden-blind-color); }
.roller-blind-item .item-type-changer:hover { background-color: var(--roller-blind-container-color); border-color: var(--roller-blind-color); }
.vertical-blind-item .item-type-changer:hover { background-color: var(--vertical-blind-container-color); border-color: var(--vertical-blind-color); }
.partition-item .item-type-changer:hover { background-color: var(--partition-container-color); border-color: var(--partition-color); }
.pleated-screen-item .item-type-changer:hover { background-color: var(--pleated-screen-container-color); border-color: var(--pleated-screen-color); }
.aluminum-blind-item .item-type-changer:hover { background-color: var(--aluminum-blind-container-color); border-color: var(--aluminum-blind-color); }


/* --- [REMASTERED] Progressive Disclosure UI/UX --- */
.btn-more {
    width: 100%;
    justify-content: center;
    gap: 0.25rem;
    background-color: transparent;
    border: 1px solid var(--outline);
}
.btn-more:hover {
    background-color: var(--surface-container);
    border-color: var(--primary);
}
.btn-more.expanded {
    background-color: var(--surface-container-high);
    color: var(--primary);
    border-color: var(--outline-variant);
}
.btn-more .ph {
    transition: transform var(--transition-speed) ease;
}
.btn-more.expanded .ph {
    transform: rotate(180deg);
}
.item-details-more {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    max-height: 0;
    overflow: hidden;
    transition: all 0.4s ease-out;
    padding: 0 0.5rem;
    background-color: transparent;
}
.item-details-more.show {
    max-height: 700px; /* Increased to fit content */
    padding: 0.75rem 0.5rem;
    border-top: 1px solid var(--outline);
}
.item-details-more fieldset {
    border: 1px solid var(--outline);
    border-radius: var(--border-radius-md);
    padding: 0.75rem;
    margin: 0;
    background-color: var(--surface);
}
.item-details-more fieldset .item-grid {
    padding: 0.25rem 0 0 0;
}
.item-details-more fieldset legend {
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--on-surface-variant);
    padding: 0 0.5rem;
    margin-left: 0.5rem;
}
.item-details-more fieldset legend i {
    font-size: 1em;
    margin-right: 0.25rem;
    color: var(--primary);
}


/* --- [REFACTORED & FIXED] FAVORITE CODES STYLES --- */
.form-group-with-favorites {
    position: relative;
    grid-column: var(--grid-column, auto);
}
.form-group-with-favorites .form-group {
    position: relative;
}
.form-group-with-favorites.full-width-item {
    --grid-column: 1 / -1;
}

/* [REMOVED] .btn-favorite styles */

/* Position for the "show list" button */
.btn-show-favs {
    position: absolute;
    right: 1px;
    bottom: 2px; /* Vertically centered */
    width: 40px;
    height: 40px;
    color: var(--on-surface-variant);
    z-index: 5;
}
.btn-show-favs:hover {
    color: var(--primary);
    background-color: var(--surface-container-high);
}
/* Style adjustments for disabled state */
.btn-show-favs:disabled {
    opacity: 0.5;
    pointer-events: none;
    background-color: transparent;
    color: var(--outline-variant);
}

/* Adjust input padding to make space for list button */
input[data-favorite-type] {
    padding-left: 0.75rem !important; /* Reset left padding */
    padding-right: 42px !important;
}

.empty-summary { color: var(--on-surface-variant); text-align: center; padding: 1rem; background-color: var(--surface-container); border-radius: var(--border-radius-md); }

/* --- FOOTER & SUMMARY --- */
.summary-footer {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: var(--glass-bg);
    backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
    border-top: 1px solid var(--glass-border);
    padding: 0.75rem; z-index: 50;
    box-shadow: 0 -5px 30px var(--shadow-color), inset 0 1px 1px var(--glass-border);
    transition: background-color var(--transition-speed), border-color var(--transition-speed), box-shadow var(--transition-speed);
}
.summary-grid {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    max-width: 800px; margin: 0 auto;
}
.footer-actions {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    min-width: 0; /* [FIX] Allow this flex item to shrink */
}
.footer-totals {
    text-align: right;
    flex-shrink: 0;
    background: none;
    border: none;
    font-family: var(--font-family);
    padding: 0;
    cursor: pointer;
    border-radius: var(--border-radius-sm);
}

/* --- [MODIFIED] 3D Button Style Base --- */
.three-d-button {
    border: 1px solid var(--outline);
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.5),
        0px 1px 1px var(--outline),
        0px 3px 4px 0px var(--shadow-color);
    transition: all 0.15s ease-out;
}
body.dark-theme .three-d-button, body.neutral-theme .three-d-button {
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.1),
        0px 1px 1px var(--outline),
        0px 3px 4px 0px var(--shadow-color);
}
.three-d-button:hover {
    filter: brightness(1.05);
    transform: translateY(-2px);
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.6),
        0px 1px 1px var(--outline),
        0px 5px 8px 2px var(--shadow-color);
}
.three-d-button:active {
    filter: brightness(0.98);
    transform: translateY(1px);
    box-shadow:
        inset 0px 3px 4px 0px rgba(0, 0, 0, 0.15),
        inset 0px -1px 1px rgba(255, 255, 255, 0.4);
    transition-duration: 0.05s;
}

/* --- Applying 3D style to specific buttons --- */
#quickNavBtn, #menuBtn {
    background-color: var(--primary-container);
    color: var(--on-primary-container);
}
#quickNavBtn, #menuBtn, #lockBtn, .btn.btn-secondary {
    border: 1px solid var(--outline);
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.5),
        0px 1px 1px var(--outline),
        0px 3px 4px 0px var(--shadow-color);
    transition: all 0.15s ease-out;
}
body.dark-theme #quickNavBtn, body.dark-theme #menuBtn, body.dark-theme #lockBtn, body.dark-theme .btn.btn-secondary,
body.neutral-theme #quickNavBtn, body.neutral-theme #menuBtn, body.neutral-theme #lockBtn, body.neutral-theme .btn.btn-secondary {
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.1),
        0px 1px 1px var(--outline),
        0px 3px 4px 0px var(--shadow-color);
}
#quickNavBtn:hover, #menuBtn:hover, #lockBtn:hover, .btn.btn-secondary:hover {
    filter: brightness(1.05);
    transform: translateY(-2px);
    box-shadow:
        inset 0px 1px 1px rgba(255, 255, 255, 0.6),
        0px 1px 1px var(--outline),
        0px 5px 8px 2px var(--shadow-color);
}
#quickNavBtn:active, #menuBtn:active, #lockBtn:active, .btn.btn-secondary:active {
    filter: brightness(0.98);
    transform: translateY(1px);
    box-shadow:
        inset 0px 3px 4px 0px rgba(0, 0, 0, 0.15),
        inset 0px -1px 1px rgba(255, 255, 255, 0.4);
    transition-duration: 0.05s;
}


#lockBtn {
    background-color: var(--surface);
}
#lockBtn.is-locked {
    color: var(--on-danger);
    background-color: var(--danger);
    border-color: var(--danger);
}
#lockBtn .ph { font-size: 1.4rem; }

/* --- [NEW] Suspended Items Button --- */
.btn-suspended {
    position: relative;
    background-color: var(--warning-container);
    color: var(--on-warning-container);
    display: none; /* Hidden by default */
}
.btn-suspended.is-visible {
    display: inline-flex; /* Show when needed */
}
.btn-suspended .ph {
    font-size: 1.5rem;
}
.btn-suspended:hover {
    background-color: var(--warning-container);
    color: var(--on-warning-container);
    filter: brightness(1.05);
}
.notification-badge {
    position: absolute;
    top: 0;
    right: 0;
    min-width: 20px;
    height: 20px;
    background-color: var(--danger);
    color: var(--on-danger);
    border-radius: 50%;
    font-size: 0.75rem;
    font-weight: 700;
    line-height: 20px;
    text-align: center;
    padding: 0 4px;
    border: 2px solid var(--background);
    transform: translate(30%, -30%);
}


.total-items {
    color: var(--on-surface-variant);
    font-size: 0.875rem;
}
.original-total {
    display: none;
    font-size: 0.9rem;
    color: var(--danger);
    text-decoration: line-through;
}
.grand-total {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--on-surface);
}
.grand-total span { color: var(--primary); }
.grand-total span span::after { content: ' บาท'; font-size: 0.9rem; font-weight: normal; }

.modal-wrapper { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 200; opacity: 0; visibility: hidden; transition: opacity var(--transition-speed), visibility var(--transition-speed); }
.modal-wrapper.visible { opacity: 1; visibility: visible; }
.modal-content {
    background: var(--surface); /* [MODIFIED] Opaque background */
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    width: 90%;
    max-width: 300px;
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--outline); /* [MODIFIED] Solid border */
    transform: scale(1);
    opacity: 1;
    transition: background-color var(--transition-speed), transform var(--transition-speed) ease, opacity var(--transition-speed) ease;
}
/* Removed backdrop-filter styles */
/* body.dark-theme .modal-content, body.neutral-theme .modal-content removed background overrides, now uses --surface */

.modal-content h3 { margin-bottom: 0.5rem; }
.modal-content h3 i {
    color: var(--primary);
    margin-right: 0.25rem;
}
.modal-content p { margin-bottom: 1.5rem; color: var(--on-surface-variant); }
.modal-actions { display: flex; justify-content: flex-end; gap: 0.5rem; margin-top: 1.5rem; }

/* MODAL STACKING BUG FIX: Styles for modal-on-modal */
.modal-wrapper.is-underlay .modal-content {
    transform: scale(0.95);
opacity: 0.6;
     pointer-events: none;
 }
+
 /* --- [BUG FIX & REFINED] Corrected Modal Z-Index Stacking --- */
 /* Highest level: Confirmation on top of everything */
 #confirmationModal.modal-wrapper {
-    z-index: 505; /* Was 503 */
+    z-index: 510; /* Highest level */
 }
-/* Level 3: Modals opened from Level 2 modals (e.g., Favorites from Force Apply Confirm) */
-#favoritesModal.modal-wrapper { /* Moved UP - Can be opened from Force Apply */
-    z-index: 504; /* Was 501 */
+/* Level 4: Modals opened from Level 3 */
+#favAddModal.modal-wrapper, #favEditModal.modal-wrapper {
+    z-index: 506; /* Opened from Fav Manager */
+}
+/* Level 3: Modals that can open Level 4 */
+#favManagerModal.modal-wrapper {
+    z-index: 505; /* Opens Add/Edit */
 }
 /* Level 2: Modals opened from Level 1 or Level 0 modals */
 #favAddModal.modal-wrapper, #favEditModal.modal-wrapper,
@@ -497,14 +503,13 @@
 #forceApplyTypeModal.modal-wrapper { /* Opens first for Force Apply */
     z-index: 502;
 }
-/* Level 1: Modals that can open Level 2 modals */
-#favManagerModal.modal-wrapper,
+/* Level 1: Modals that can open Level 2 or 3 modals */
+#favoritesModal.modal-wrapper, /* Opens Fav Manager */
 #manageFavsTypeModal.modal-wrapper {
-    z-index: 501;
+    z-index: 503; /* Lower than Fav Manager/Add/Edit */
 }
 /* Level 0: Base modals that can open Level 1 modals */
 #roomDefaultsModal.modal-wrapper {
     z-index: 500;
 }
 /* Other modals not in this stack (like discountModal, overviewModal, etc.)
-   will use the default .modal-wrapper z-index of 200, which is correct. */
+   will use the default .modal-wrapper z-index of 200. */
 /* --- [END BUG FIX & REFINED] --- */


/* --- DISCOUNT MODAL --- */
#discountModal .modal-content {
    max-width: 400px;
}

.discount-modal-body {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 1.5rem;
}
.discount-modal-body hr {
    border: none;
    border-top: 1px solid var(--outline);
    margin: 0.5rem 0;
}
.discount-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1rem;
}
.discount-row.input-row {
    background-color: var(--surface-container);
    padding: 0.5rem 0.75rem;
    border-radius: var(--border-radius-md);
}
.discount-label {
    color: var(--on-surface-variant);
    font-weight: 500;
}
.discount-value {
    font-weight: 700;
    color: var(--on-surface);
}
.discount-deduction {
    color: var(--danger);
}
.discount-final {
    font-size: 1.25rem;
    color: var(--primary);
}
.final-total-row {
    padding-top: 0.5rem;
}
.discount-input {
    width: 120px;
    max-width: 40%;
    flex-grow: 0;
    flex-shrink: 1;
    padding: 0.5rem;
    text-align: right;
    border-radius: var(--border-radius-sm);
}

/* --- [REDESIGNED] OVERVIEW MODAL --- */
.overview-modal-content {
    max-width: 600px;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    padding: 1rem 1.5rem;
}
.overview-modal-header-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.overview-modal-header-bar h3 {
    margin: 0;
}
#overviewModalCancel.btn-icon {
    color: var(--on-surface-variant);
    width: 38px;
    height: 38px;
    background-color: var(--surface-container);
    border-radius: 50%;
    transition: all var(--transition-speed);
}
#overviewModalCancel.btn-icon:hover {
    background-color: var(--surface-container-high);
    color: var(--danger);
    transform: scale(1.05);
}
#overviewModalHeader {
    padding-top: 0;
}
.overview-stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
}
.overview-stat-card {
    background-color: var(--surface-container);
    border-radius: var(--border-radius-md);
    padding: 0.75rem;
    text-align: center;
    border: 1px solid var(--outline);
}
.overview-stat-card i {
    font-size: 1.5rem;
    color: var(--primary);
    margin-bottom: 0.25rem;
}
.overview-stat-card .stat-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--on-surface);
    line-height: 1.2;
}
.overview-stat-card .stat-label {
    font-size: 0.75rem;
    color: var(--on-surface-variant);
}
#overviewModalBody {
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    padding: 0.5rem;
    margin: 0 -0.5rem;
}
.overview-summary-group, .overview-breakdown-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}
.overview-summary-group h4, .overview-breakdown-group h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--outline);
    margin: 0 0.25rem 0.25rem;
}
.summary-tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.25rem;
}
.summary-tag {
    background-color: var(--surface-container);
    color: var(--on-surface-variant);
    padding: 0.35rem 0.75rem;
    border-radius: var(--border-radius-xl);
    font-size: 0.85rem;
    font-weight: 500;
    border: 1px solid var(--outline);
}
.summary-tag[data-filter-type] {
    cursor: pointer;
    transition: all var(--transition-speed);
}
.summary-tag[data-filter-type]:hover {
    border-color: var(--primary);
    background-color: var(--primary-container);
    color: var(--on-primary-container);
}
.summary-tag strong {
    font-weight: 700;
    color: var(--on-surface);
    margin-left: 0.35rem;
}
/* --- [NEW] Overview Modal Filter Tag Colors --- */
.summary-tag[data-filter-type] { border: 1px solid currentColor; }
.summary-tag[data-filter-type="set"] { color: var(--curtain-color); }
.summary-tag[data-filter-type="set"]:hover { background-color: var(--curtain-container-color); }
.summary-tag[data-filter-type="wallpaper"] { color: var(--wallpaper-color); }
.summary-tag[data-filter-type="wallpaper"]:hover { background-color: var(--wallpaper-container-color); }
.summary-tag[data-filter-type="wooden_blind"] { color: var(--wooden-blind-color); }
.summary-tag[data-filter-type="wooden_blind"]:hover { background-color: var(--wooden-blind-container-color); }
.summary-tag[data-filter-type="roller_blind"] { color: var(--roller-blind-color); }
.summary-tag[data-filter-type="roller_blind"]:hover { background-color: var(--roller-blind-container-color); }
.summary-tag[data-filter-type="vertical_blind"] { color: var(--vertical-blind-color); }
.summary-tag[data-filter-type="vertical_blind"]:hover { background-color: var(--vertical-blind-container-color); }
.summary-tag[data-filter-type="partition"] { color: var(--partition-color); }
.summary-tag[data-filter-type="partition"]:hover { background-color: var(--partition-container-color); }
.summary-tag[data-filter-type="pleated_screen"] { color: var(--pleated-screen-color); }
.summary-tag[data-filter-type="pleated_screen"]:hover { background-color: var(--pleated-screen-container-color); }
.summary-tag[data-filter-type="aluminum_blind"] { color: var(--aluminum-blind-color); }
.summary-tag[data-filter-type="aluminum_blind"]:hover { background-color: var(--aluminum-blind-container-color); }
.overview-room-card {
    background-color: var(--surface);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--outline);
    overflow: hidden;
}
.overview-room-summary {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    cursor: pointer;
    list-style: none;
}
.overview-room-summary::-webkit-details-marker { display: none; }
.overview-room-summary .room-name {
    font-weight: 700;
    color: var(--on-surface);
}
.overview-room-summary .summary-tags {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}
.overview-room-summary .room-item-count {
    font-size: 0.85rem;
    background-color: var(--primary-container);
    color: var(--on-primary-container);
    padding: 0.2rem 0.6rem;
    border-radius: var(--border-radius-xl);
    font-weight: 500;
}
.overview-room-summary .expand-icon {
    transition: transform var(--transition-speed) ease;
    color: var(--on-surface-variant);
}
.overview-room-card[open] > .overview-room-summary .expand-icon {
    transform: rotate(180deg);
}
.overview-room-items {
    padding: 0.75rem;
    border-top: 1px solid var(--outline);
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    background-color: var(--surface-container);
}
.overview-item {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: var(--on-surface-variant);
    padding: 0.25rem 0;
}
.overview-item span:last-child {
    font-weight: 700;
    color: var(--on-surface);
}

/* --- [REMASTERED] LOOK BOOK MODAL --- */
.lookbook-modal-content {
    max-width: 90%;
    width: 700px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    padding: 0;
}
.lookbook-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--outline);
    flex-shrink: 0;
}
.lookbook-modal-header h3 { margin: 0; }
.lookbook-modal-body {
    overflow-y: auto;
    padding: 1.0rem;
    background-color: var(--surface-container);
}
.lookbook-summary {
    background-color: var(--surface);
    border: 1px solid var(--outline);
    border-radius: var(--border-radius-lg);
    padding: 1rem;
    margin-bottom: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 1rem;
}
.lookbook-customer-info {
    font-size: 0.9rem;
    line-height: 1.6;
}
.lookbook-totals {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.25rem;
    font-size: 0.9rem;
    text-align: right;
    color: var(--on-surface-variant);
}
.lookbook-totals .grand-total {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--primary);
    margin-top: 0.25rem;
}
.lookbook-room {
    background-color: var(--surface);
    border: 1px solid var(--outline);
    border-radius: var(--border-radius-lg);
    margin-bottom: 1.5rem;
    overflow: hidden;
}
.lookbook-room h4 {
    background-color: var(--surface-container-high);
    padding: 0.75rem 1.25rem;
    margin: 0;
    border-bottom: 1px solid var(--outline);
    font-size: 1.1rem;
}
.lookbook-room h4 i { color: var(--primary); }
.lookbook-details {
    display: flex;
    gap: 1.0rem;
    padding: 0.75rem;
    align-items: flex-start;
}
.visual-placeholder {
    width: 140px;
    height: 140px;
    background-color: var(--surface-container);
    border: 1px solid var(--outline);
    border-radius: var(--border-radius-md);
    flex-shrink: 0;
}
.visual-placeholder.is-clickable {
    cursor: pointer;
    transition: box-shadow var(--transition-speed), border-color var(--transition-speed);
    position: relative;
}
.visual-placeholder.is-clickable:hover {
    box-shadow: 0 0 0 3px var(--primary-container);
    border-color: var(--primary);
}
.visual-placeholder.is-clickable::after {
    content: "\ef0d"; /* Phosphor icon code for ArrowSquareOut */
    font-family: "Phosphor-Bold";
    position: absolute;
    top: 4px;
    right: 4px;
    font-size: 1.2rem;
    color: var(--on-primary-container);
    background-color: var(--primary-container);
    border-radius: var(--border-radius-sm);
    width: 28px;
    height: 28px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transform: scale(0.8);
    transition: all var(--transition-speed);
}
.visual-placeholder.is-clickable:hover::after {
    opacity: 1;
    transform: scale(1);
}
.visual-placeholder svg {
    width: 100%;
    height: 100%;
}
.spec-table-wrapper {
    flex-grow: 1;
}
.spec-table {
    width: 100%;
    border-collapse: collapse;
}
.spec-table td {
    padding: 0.35rem 0;
    border-bottom: 1px solid var(--outline);
    font-size: 0.95rem;
}
.spec-table tr:last-child td { border-bottom: none; }
.spec-table td:first-child {
    font-weight: 500;
    color: var(--on-surface-variant);
    width: 45px;
}
.spec-table td strong { color: var(--on-surface); }
.lookbook-hr {
    border: 0;
    border-top: 1px solid var(--outline);
    margin: 0;
}
/* SVG Styles */
.curtain-panel-opaque { fill: var(--surface-container-high); stroke: var(--on-surface-variant); stroke-width: 0.5; }
.curtain-panel-sheer { fill: var(--surface); stroke: var(--outline-variant); stroke-width: 0.5; opacity: 0.7; }
.style-grommet { fill: var(--outline-variant); stroke: var(--on-surface-variant); stroke-width: 0.75; }
.style-ripplefold-path { fill: none; stroke: var(--on-surface-variant); stroke-width: 1.5; }
.style-pleat-text { font-size: 4px; fill: var(--on-surface-variant); font-family: monospace; }
.style-pleat-line { stroke: var(--on-surface-variant); stroke-width: 0.6; opacity: 0.8; }
.style-pleat-stitch { fill: var(--on-surface-variant); stroke: none; }
.dimension-line, .dimension-tick { stroke: var(--on-surface-variant); stroke-width: 0.75; }
.dimension-line { stroke-dasharray: 2 2; }
.dimension-text { font-size: 8px; fill: var(--on-surface); text-anchor: middle; }
.fallback-text { font-size: 12px; font-weight: 500; fill: var(--on-surface-variant); text-anchor: middle; dominant-baseline: middle; }
/* ... โค้ดเดิม (เช่น .fallback-text) ... */

/* --- [FIX & NEW] SVG Visualization Styles --- */

/* [FIX] สไตล์ลูกศร (จากครั้งก่อน) */
.opening-text {
    text-anchor: middle;
    font-size: 10px;
    font-weight: bold;
    fill: var(--on-surface);
    dominant-baseline: central;
}
.opening-text-bg {
    fill: var(--surface-container);
    stroke: var(--outline);
    opacity: 0.85;
}

/* [NEW] ใช้สำหรับ กรอบม่าน, ฉากกั้น, วอลเปเปอร์ */
.blind-frame {
    fill: var(--surface);
    stroke: var(--outline-variant);
    stroke-width: 0.5;
}

/* [NEW] ใช้สำหรับ ใบม่าน (ม่านพับ, ม่านปรับแสง, มู่ลี่อลูมิเนียม) */
.blind-slat {
    fill: var(--surface-container-high);
    stroke: var(--outline);
    stroke-width: 0.25;
}

/* [NEW] ใช้สำหรับ มู่ลี่ไม้ */
.wooden-blind-slat {
    fill: var(--wooden-blind-container-color); /* ใช้สีตามประเภทสินค้า */
    stroke: var(--wooden-blind-color);
    stroke-width: 0.3;
}
.wooden-blind-strip {
    fill: var(--on-surface-variant);
    opacity: 0.6;
}

/* [NEW] ใช้สำหรับ ม่านม้วน */
.roller-fabric {
    fill: var(--roller-blind-container-color); /* ใช้สีตามประเภทสินค้า */
    stroke: var(--roller-blind-color);
    stroke-width: 0.5;
}
.roller-roll {
    fill: var(--surface-container-high);
    stroke: var(--outline-variant);
    stroke-width: 0.5;
}
.roller-bar {
    stroke: var(--on-surface-variant);
    stroke-width: 1.5;
}

/* [NEW] ใช้สำหรับ ฉากกั้น / ม่านจีบ (Pleated) */
.partition-panel {
    fill: var(--partition-container-color);
    stroke: var(--partition-color);
    stroke-width: 0.4;
}
.partition-hinge {
    stroke: var(--outline-variant);
    stroke-width: 0.5;
}
.pleated-screen-mesh {
    stroke: var(--pleated-screen-color);
    stroke-width: 0.5;
    opacity: 0.6;
}

/* [NEW] ใช้สำหรับ วอลเปเปอร์ */
.wallpaper-pattern {
    fill: var(--wallpaper-color);
    opacity: 0.5;
}

/* [NEW] ใช้สำหรับ สายปรับ (ม่านม้วน, ม่านพับ) */
.adjustment-cord {
    stroke: var(--on-surface-variant);
    stroke-width: 0.75;
    fill: var(--on-surface-variant);
    opacity: 0.8;
}

/* ... โค้ดเดิม (เช่น .louis-swag) ... */
.louis-swag { fill: var(--curtain-container-color); stroke: var(--curtain-color); stroke-width: 0.8; opacity: 0.9; }
.louis-tail { fill: var(--curtain-container-color); stroke: var(--curtain-color); stroke-width: 0.8; opacity: 0.9; }
.louis-tassel { fill: var(--warning); stroke: var(--on-warning-container); stroke-width: 0.5; }


#toast-container { position: fixed; top: 1rem; left: 50%; transform: translateX(-50%); z-index: 300; display: flex; flex-direction: column; gap: 0.5rem; align-items: center; }
.toast { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1.25rem; border-radius: var(--border-radius-xl); box-shadow: var(--shadow-lg); opacity: 0; transform: translateY(-150%); transition: transform 0.4s ease, opacity 0.4s ease; background-color: var(--info-container); color: var(--on-info-container); border: 1px solid var(--outline); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
.toast i { font-size: 1.5em; color: var(--info); }
.toast.show { transform: translateY(0); opacity: 1; }
.toast-success { background-color: var(--success-container); color: var(--on-success-container); }
.toast-success i { color: var(--success); }
.toast-warning { background-color: var(--warning-container); color: var(--on-warning-container); }
.toast-warning i { color: var(--warning); }
.toast-error { background-color: var(--danger-container); color: var(--on-danger-container); }
.toast-error i { color: var(--danger); }

/* --- MENU STYLES (HEADER & FOOTER) --- */
.menu-container { position: relative; }
.menu-dropdown {
    position: absolute; top: calc(100% + 8px); right: 0;
    background-color: var(--surface); /* [MODIFIED] Opaque background */
    border-radius: var(--border-radius-md); box-shadow: var(--shadow-lg); border: 1px solid var(--outline); /* [MODIFIED] Solid border */
    overflow: hidden; display: flex; flex-direction: column; width: max-content;
    opacity: 0; visibility: hidden;
    transform: translateY(-10px);
    transition: all var(--transition-speed) ease;
    z-index: 110;
}
.menu-dropdown.show { opacity: 1; visibility: visible; transform: translateY(0); }
.menu-dropdown a { padding: 0.75rem 1.25rem; text-decoration: none; color: var(--on-surface); display: flex; align-items: center; gap: 0.75rem; }
.menu-dropdown a:hover { background-color: var(--surface-container); }
.menu-dropdown a.danger { color: var(--danger); }
.menu-dropdown a.danger:hover { background-color: var(--danger-container); }
.menu-dropdown hr { border: none; border-top: 1px solid var(--outline); margin: 0.25rem 0; }
.hidden { display: none !important; }
.item-hidden { display: none !important; }

/* --- FOOTER QUICKNAV & 3D BUTTON MODIFICATION --- */
#menuBtn {
    height: 44px;
    padding: 0 1.25rem;
    font-size: 1rem;
    border-radius: var(--border-radius-xl);
}
#menuBtn i {
    font-size: 1.4rem;
}

#quickNavBtn {
    border-radius: var(--border-radius-xl);
    width: auto;
    max-width: 220px;
    height: 44px;
    padding: 0 1rem;
    font-weight: 700;
    font-size: 0.9rem;
}
#quickNavBtnText {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: inline-block;
    vertical-align: middle;
}

.summary-footer .menu-dropdown {
    bottom: calc(100% + 8px);
    top: auto;
    left: 0;
    right: auto;
    transform: translateY(10px);
    background-color: var(--surface); /* [MODIFIED] Opaque background */
    border: 1px solid var(--outline); /* [MODIFIED] Solid border */
}
.summary-footer .menu-dropdown.show {
    transform: translateY(0);
}
.quick-nav-actions {
    display: flex;
    justify-content: space-around;
    gap: 0.5rem;
    padding: 0.5rem 1.25rem 0.75rem;
}
.quick-nav-actions .btn-chip {
    flex-grow: 1; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;
}
.quick-nav-title {
    padding: 0.75rem 1.25rem 0.25rem;
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--on-surface-variant);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
#quickNavDropdown #quickNavRoomList {
    max-height: 40vh;
    overflow-y: auto;
}
#quickNavDropdown #quickNavRoomList a {
    padding: 0.75rem 1.25rem; text-decoration: none; color: var(--on-surface); display: flex; align-items: center; gap: 0.75rem;
}
#quickNavDropdown #quickNavRoomList a:hover {
    background-color: var(--surface-container);
}

/* --- Radio Chip & Card Styles --- */
.radio-group {
    display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;
}
.radio-group input[type="radio"] { display: none; }
.radio-group label { flex-grow: 1; }
.radio-group label span {
    display: block; text-align: center; padding: 0.75rem 1rem; border: 2px solid var(--outline); border-radius: var(--border-radius-md);
    background-color: var(--surface); color: var(--on-surface-variant); cursor: pointer; transition: all var(--transition-speed); font-weight: 500;
}
.radio-group label:hover span {
    border-color: var(--outline-variant); background-color: var(--surface-container);
}
.radio-group input[type="radio"]:checked + span {
    background-color: var(--primary-container); border-color: var(--primary); color: var(--on-primary-container); font-weight: 700;
}

.radio-card-group {
    display: flex; flex-direction: column; gap: 0.75rem; margin-top: 1.5rem;
}
.radio-card-group input[type="radio"] { display: none; }
.radio-card-group label { display: block; }
.radio-card-group .radio-card-content {
    display: block; border: 2px solid var(--outline); border-radius: var(--border-radius-md); padding: 1rem;
    cursor: pointer;
    transition: background-color var(--transition-speed), border-color var(--transition-speed), box-shadow var(--transition-speed);
    box-shadow: 0 0 0 2px transparent;
}
.radio-card-group label:hover .radio-card-content {
     background-color: var(--surface-container); border-color: var(--outline-variant);
}
.radio-card-group input[type="radio"]:checked + .radio-card-content {
    border-color: var(--primary); background-color: var(--primary-container); box-shadow: 0 0 0 2px var(--primary-container);
}
.radio-card-group .radio-card-content strong {
    color: var(--on-surface); font-size: 1rem;
}
.radio-card-group .radio-card-content i {
    margin-right: 0.5rem;
    color: var(--primary);
    font-size: 1.1em;
    vertical-align: text-bottom;
}
.radio-card-group .radio-card-content small {
    display: block; color: var(--on-surface-variant); font-size: 0.875rem;
}

/* --- [NEW] Radio Card Group Item Colors --- */
.radio-card-group label[data-item-type]:hover .radio-card-content {
    background-color: var(--surface-container-high);
}
.radio-card-group input[type="radio"]:checked + .radio-card-content {
    box-shadow: 0 0 0 2px var(--surface-container-high);
}
.radio-card-group input[type="radio"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"]:checked + .radio-card-content i {
    font-weight: 700;
}
/* Curtain */
.radio-card-group label[data-item-type="set"]:hover .radio-card-content,
.radio-card-group label[data-item-type="fabric"]:hover .radio-card-content, /* Added fabric */
.radio-card-group label[data-item-type="sheer"]:hover .radio-card-content { border-color: var(--curtain-color); } /* Added sheer */
.radio-card-group input[type="radio"][value="set"]:checked + .radio-card-content,
.radio-card-group input[type="radio"][value="fabric"]:checked + .radio-card-content, /* Added fabric */
.radio-card-group input[type="radio"][value="sheer"]:checked + .radio-card-content { /* Added sheer */
    border-color: var(--curtain-color); background-color: var(--curtain-container-color); }
.radio-card-group input[type="radio"][value="set"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="set"]:checked + .radio-card-content i,
.radio-card-group input[type="radio"][value="fabric"]:checked + .radio-card-content strong, /* Added fabric */
.radio-card-group input[type="radio"][value="fabric"]:checked + .radio-card-content i, /* Added fabric */
.radio-card-group input[type="radio"][value="sheer"]:checked + .radio-card-content strong, /* Added sheer */
.radio-card-group input[type="radio"][value="sheer"]:checked + .radio-card-content i { color: var(--curtain-color); } /* Added sheer */
/* Wallpaper */
.radio-card-group label[data-item-type="wallpaper"]:hover .radio-card-content { border-color: var(--wallpaper-color); }
.radio-card-group input[type="radio"][value="wallpaper"]:checked + .radio-card-content {
    border-color: var(--wallpaper-color); background-color: var(--wallpaper-container-color); }
.radio-card-group input[type="radio"][value="wallpaper"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="wallpaper"]:checked + .radio-card-content i { color: var(--wallpaper-color); }
/* Wooden Blind */
.radio-card-group label[data-item-type="wooden_blind"]:hover .radio-card-content { border-color: var(--wooden-blind-color); }
.radio-card-group input[type="radio"][value="wooden_blind"]:checked + .radio-card-content {
    border-color: var(--wooden-blind-color); background-color: var(--wooden-blind-container-color); }
.radio-card-group input[type="radio"][value="wooden_blind"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="wooden_blind"]:checked + .radio-card-content i { color: var(--wooden-blind-color); }
/* Roller Blind */
.radio-card-group label[data-item-type="roller_blind"]:hover .radio-card-content { border-color: var(--roller-blind-color); }
.radio-card-group input[type="radio"][value="roller_blind"]:checked + .radio-card-content {
    border-color: var(--roller-blind-color); background-color: var(--roller-blind-container-color); }
.radio-card-group input[type="radio"][value="roller_blind"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="roller_blind"]:checked + .radio-card-content i { color: var(--roller-blind-color); }
/* Vertical Blind */
.radio-card-group label[data-item-type="vertical_blind"]:hover .radio-card-content { border-color: var(--vertical-blind-color); }
.radio-card-group input[type="radio"][value="vertical_blind"]:checked + .radio-card-content {
    border-color: var(--vertical-blind-color); background-color: var(--vertical-blind-container-color); }
.radio-card-group input[type="radio"][value="vertical_blind"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="vertical_blind"]:checked + .radio-card-content i { color: var(--vertical-blind-color); }
/* Partition */
.radio-card-group label[data-item-type="partition"]:hover .radio-card-content { border-color: var(--partition-color); }
.radio-card-group input[type="radio"][value="partition"]:checked + .radio-card-content {
    border-color: var(--partition-color); background-color: var(--partition-container-color); }
.radio-card-group input[type="radio"][value="partition"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="partition"]:checked + .radio-card-content i { color: var(--partition-color); }
/* Pleated Screen */
.radio-card-group label[data-item-type="pleated_screen"]:hover .radio-card-content { border-color: var(--pleated-screen-color); }
.radio-card-group input[type="radio"][value="pleated_screen"]:checked + .radio-card-content {
    border-color: var(--pleated-screen-color); background-color: var(--pleated-screen-container-color); }
.radio-card-group input[type="radio"][value="pleated_screen"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="pleated_screen"]:checked + .radio-card-content i { color: var(--pleated-screen-color); }
/* Aluminum Blind */
.radio-card-group label[data-item-type="aluminum_blind"]:hover .radio-card-content { border-color: var(--aluminum-blind-color); }
.radio-card-group input[type="radio"][value="aluminum_blind"]:checked + .radio-card-content {
    border-color: var(--aluminum-blind-color); background-color: var(--aluminum-blind-container-color); }
.radio-card-group input[type="radio"][value="aluminum_blind"]:checked + .radio-card-content strong,
.radio-card-group input[type="radio"][value="aluminum_blind"]:checked + .radio-card-content i { color: var(--aluminum-blind-color); }


/* --- Range Slider Styles --- */
.range-slider-group {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
}
.range-slider-group input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 8px;
    background: var(--surface-container-high);
    border-radius: var(--border-radius-sm);
    outline: none;
    transition: opacity .2s;
}
.range-slider-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    background: var(--primary);
    cursor: pointer;
    border-radius: 50%;
    border: 4px solid var(--primary-container);
    box-shadow: var(--shadow-sm);
}
.range-slider-group input[type="range"]::-moz-range-thumb {
    width: 16px;
    height: 16px;
    background: var(--primary);
    cursor: pointer;
    border-radius: 50%;
    border: 4px solid var(--primary-container);
    box-shadow: var(--shadow-sm);
}
.range-slider-value {
    font-weight: 700;
    color: var(--on-primary-container);
    background-color: var(--primary-container);
    padding: 0.25rem 0.75rem;
    border-radius: var(--border-radius-sm);
    min-width: 32px;
    text-align: center;
}

@keyframes highlight-and-fade-in { 0% { opacity: 0; transform: translateY(15px); background-color: transparent; } 50% { opacity: 1; background-color: var(--primary-container); } 100% { opacity: 1; transform: translateY(0); background-color: transparent; } }
.item-created { animation: highlight-and-fade-in 1.2s ease-out forwards; }
@keyframes fade-out-and-shrink { from { opacity: 1; transform: scale(1); max-height: 500px; margin-bottom: 1.5rem; padding-top: 1rem; padding-bottom: 1rem; } to { opacity: 0; transform: scale(0.95); max-height: 0; margin-bottom: 0; padding-top: 0; padding-bottom: 0; border-width: 0; } }
.item-removing { overflow: hidden; animation: fade-out-and-shrink 0.4s ease-in forwards; }
.item-removing.card { margin-bottom: 1.5rem; }
.item-removing.item-card { margin-bottom: 1rem; }
.item-removing.wall-input-row { margin-bottom: 0.5rem; }

/* --- [BUG FIX] Make wall row animation visible --- */
.wall-input-row {
    padding: 2px;
    margin: -2px; /* Prevents layout shift from padding */
    border-radius: var(--border-radius-sm);
}


@keyframes yellow-fade { 0% { background-color: var(--warning-container); } 100% { background-color: var(--surface-container); } }
.input-highlight { animation: yellow-fade 1.2s ease-out; }

/* --- FILTER STATUS BAR --- */
.filter-status-bar {
    display: none;
    justify-content: space-between;
    align-items: center;
    padding: 0.4rem 1rem;
    background-color: var(--info-container);
    color: var(--on-info-container);
    border-radius: var(--border-radius-md);
    margin-bottom: 1.5rem;
    position: sticky;
    top: 80px;
    z-index: 90;
    box-shadow: var(--shadow-md);
    border: 1px solid var(--info);
    transition: background-color 0.4s ease, color 0.4s ease, border-color 0.4s ease;
}
.filter-status-bar.is-visible {
    display: flex;
}
.filter-status-bar span strong {
    font-weight: 700;
    margin-left: 0.25rem;
}
.filter-status-bar .btn-chip {
    background-color: var(--surface);
    color: var(--on-surface-variant);
    padding: 0.4rem 0.8rem;
    border-color: var(--outline-variant);
}
.filter-status-bar .btn-chip:hover {
    background-color: var(--surface-container-high);
}

/* --- [NEW] Filter Status Bar Type Colors --- */
.filter-status-bar[data-filter-type] .btn-chip {
    background-color: var(--surface);
    color: inherit;
    border-color: currentColor;
    opacity: 0.8;
}
.filter-status-bar[data-filter-type] .btn-chip:hover {
    opacity: 1;
    background-color: var(--surface-container);
}

.filter-status-bar[data-filter-type="set"] { background-color: var(--curtain-container-color); color: var(--curtain-color); border-color: var(--curtain-color); }
.filter-status-bar[data-filter-type="wallpaper"] { background-color: var(--wallpaper-container-color); color: var(--wallpaper-color); border-color: var(--wallpaper-color); }
.filter-status-bar[data-filter-type="wooden_blind"] { background-color: var(--wooden-blind-container-color); color: var(--wooden-blind-color); border-color: var(--wooden-blind-color); }
.filter-status-bar[data-filter-type="roller_blind"] { background-color: var(--roller-blind-container-color); color: var(--roller-blind-color); border-color: var(--roller-blind-color); }
.filter-status-bar[data-filter-type="vertical_blind"] { background-color: var(--vertical-blind-container-color); color: var(--vertical-blind-color); border-color: var(--vertical-blind-color); }
.filter-status-bar[data-filter-type="partition"] { background-color: var(--partition-container-color); color: var(--partition-color); border-color: var(--partition-color); }
.filter-status-bar[data-filter-type="pleated_screen"] { background-color: var(--pleated-screen-container-color); color: var(--pleated-screen-color); border-color: var(--pleated-screen-color); }
.filter-status-bar[data-filter-type="aluminum_blind"] { background-color: var(--aluminum-blind-container-color); color: var(--aluminum-blind-color); border-color: var(--aluminum-blind-color); }
.filter-status-bar[data-filter-type="suspended"] { background-color: var(--warning-container); color: var(--on-warning-container); border-color: var(--warning); }


/* --- LOADING OVERLAY --- */
#loading-overlay {
    position: fixed;
    inset: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    color: var(--on-primary);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
}
#loading-overlay p {
    margin-top: 1rem;
    font-size: 1rem;
    font-weight: 500;
}
.loading-spinner {
    width: 48px;
    height: 48px;
    border: 5px solid var(--on-primary);
    border-bottom-color: transparent;
    border-radius: 50%;
    display: inline-block;
    box-sizing: border-box;
    animation: rotation 1s linear infinite;
}
@keyframes rotation {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* --- PDF & PRINT STYLES (ENHANCED) --- */
#printable-content { display: none; }
#printable-content * { box-sizing: border-box; }
#quotation-template {
    font-family: 'Noto Sans Thai', sans-serif;
    color: #333;
    font-size: 10pt;
    background-color: #fff;
}
.pdf-page {
    width: 210mm;
    min-height: 297mm;
    page-break-after: always;
    display: block;
    position: relative;
    background: #fff;
    overflow: hidden;
}
.pdf-page:last-child {
    page-break-after: avoid;
}
.pdf-page-content {
    padding: 12mm 12mm 20mm 12mm;
    height: 100%;
    display: flex;
    flex-direction: column;
}
.pdf-page-body {
    flex-grow: 1;
}
.pdf-summary-wrapper {
    margin-top: auto;
    page-break-inside: avoid;
}

.pdf-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8mm; border-bottom: 3px solid #002D62; padding-bottom: 5mm; }
.pdf-shop-info { display: flex; align-items: flex-start; gap: 4mm; }
.pdf-logo { max-width: 60px; max-height: 60px; object-fit: contain; }
.pdf-shop-address { font-size: 9pt; line-height: 1.4; }
.pdf-shop-address strong { color: #002D62; }
.pdf-quote-details { text-align: right; flex-shrink: 0; }
.pdf-title-box { background-color: #002D62; color: #FFFFFF; padding: 2mm 5mm; margin-bottom: 2mm; display: inline-block; }
.pdf-title-box h1 { font-size: 14pt; color: inherit; font-weight: 700; margin: 0; }
.pdf-quote-meta { font-size: 10pt; border-collapse: collapse; margin-left: auto; }
.pdf-quote-meta td { padding: 1mm 0 1mm 2mm; }
.pdf-quote-meta td:first-child { font-weight: bold; color: #002D62; }
.pdf-customer-details { display: flex; justify-content: space-between; padding: 4mm; border: 1px solid #BCC2CB; margin-bottom: 8mm; font-size: 10pt; line-height: 1.6; page-break-inside: avoid; background-color: #F8F9FC; }
.pdf-customer-info { flex-basis: 60%; }
.pdf-customer-meta { flex-basis: 35%; text-align: right; }
.pdf-customer-details strong { font-weight: 700; color: #333; }
.pdf-items-table { width: 100%; border-collapse: collapse; }
.pdf-items-table th, .pdf-items-table td { border: 1px solid #ddd; padding: 2.5mm 2mm; vertical-align: top; line-height: 1.5; }
.pdf-items-table thead { display: table-header-group; }
.pdf-items-table thead th { background-color: #002D62; color: #FFFFFF; font-weight: bold; text-align: center; }
.pdf-items-table tbody tr { page-break-inside: avoid; }
.pdf-items-table tbody tr:nth-child(even) { background-color: #f9f9f9; }
.pdf-items-table td small { color: #555; font-size: 8.5pt; }
.pdf-room-header td { background-color: #EEEFEA !important; font-weight: bold; color: #002D62; }
.pdf-text-center { text-align: center; }
.pdf-text-right { text-align: right; }
.pdf-summary-section { display: flex; justify-content: space-between; align-items: flex-start; padding-top: 5mm; border-top: 2px solid #002D62; }
.pdf-amount-in-words { flex-basis: 55%; font-size: 9pt; }
.pdf-amount-in-words ul { padding-left: 5mm; margin: 2mm 0; }
.pdf-amount-in-words li { margin-bottom: 1mm; }
.pdf-amount-text { background-color: #EEEFEA; padding: 2mm; text-align: center; font-weight: bold; margin-top: 3mm; color: #002D62; }
.pdf-totals-block { flex-basis: 40%; }
.pdf-totals-block table { width: 100%; border-collapse: collapse; font-size: 10pt; }
.pdf-totals-block .pdf-label { text-align: right; padding: 2.5mm; font-weight: 700; }
.pdf-totals-block .pdf-amount { text-align: right; padding: 2.5mm; border-bottom: 1px solid #ccc; }
.pdf-grand-total .pdf-label { font-size: 11pt; }
.pdf-grand-total .pdf-amount { background-color: #002D62; color: #FFFFFF; font-weight: bold; font-size: 12pt; border-bottom: none; }
.pdf-footer-section { display: flex; justify-content: space-between; text-align: center; font-size: 9pt; margin-top: 10mm; border-top: 1px solid #ccc; padding-top: 5mm; }
.pdf-signature-box { flex-basis: 48%; }
.pdf-signature-box p { margin: 1mm 0; }
.pdf-signature-box p:first-child { margin-top: 15mm; }
.pdf-page-footer {
    position: absolute; bottom: 8mm; left: 12mm; right: 12mm;
    font-size: 8pt; color: #666;
    border-top: 1px solid #ccc; padding-top: 5px;
}
.pdf-footer-info { display: flex; justify-content: space-between; }
.pdf-subtotal-row td {
    font-weight: bold; background-color: #f2f2f2 !important; font-size: 9.5pt; font-style: italic;
}

@media print {
    @page { margin: 0; }
    body {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
    }
    body > *:not(#printable-content) { display: none !important; }
    #printable-content { display: block !important; }
    .pdf-page {
        margin: 0;
        width: 100%;
        height: auto;
        min-height: 0;
        border: none;
        box-shadow: none;
        overflow: visible;
    }
    .pdf-page-content { padding: 15mm 12mm 10mm 12mm; height: auto; }
    .pdf-page-footer { position: static; padding-top: 10mm; }
    .pdf-title-box, .pdf-items-table thead th, .pdf-grand-total .pdf-amount, .pdf-room-header td, .pdf-subtotal-row td, .pdf-amount-text {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
    }
}

.disable-animations *, .disable-animations *::before, .disable-animations *::after {
    animation-duration: 0s !important;
    animation-delay: 0s !important;
    transition-duration: 0s !important;
    transition-delay: 0s !important;
    scroll-behavior: auto !important;
}

.scrolling-jump {
    outline: 3px solid var(--primary) !important;
    box-shadow: 0 6px 25px var(--glow-color) !important;
    transition: box-shadow 0.5s ease, outline 0.5s ease;
    border-radius: var(--border-radius-lg);
}

/* --- [NEW] Favorites Selector Modal --- */
#favoritesModal .modal-content {
    max-width: 450px;
    width: 95%;
    display: flex;
    flex-direction: column;
    padding: 0;
    max-height: 80vh;
}
.fav-selector-header {
    padding: 1rem 1.5rem 0.75rem;
    border-bottom: 1px solid var(--outline);
    flex-shrink: 0;
}
.fav-selector-header h3 {
    margin-bottom: 0.75rem;
}
.fav-selector-search-wrapper {
    position: relative;
}
.fav-selector-search-wrapper .ph {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--on-surface-variant);
    font-size: 1.2rem;
    pointer-events: none;
}
.fav-selector-search {
    width: 100%;
    padding: 0.65rem 0.75rem 0.65rem 40px;
    border-radius: var(--border-radius-md);
    border: 1px solid var(--outline);
    background-color: var(--surface-container);
    color: var(--on-surface);
    font-size: 1rem;
}
.fav-selector-search:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px var(--primary-container);
    background-color: var(--surface);
}
.fav-selector-body {
    overflow-y: auto;
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    flex-grow: 1;
}
.fav-selector-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 0.75rem 1rem;
    border-radius: var(--border-radius-md);
    border: 1px solid transparent;
    background: none;
    font-family: var(--font-family);
    cursor: pointer;
    text-align: left;
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}
.fav-selector-item:hover {
    background-color: var(--surface-container);
    border-color: var(--outline-variant);
}
.fav-selector-item:focus, .fav-selector-item:active {
    outline: none;
    border-color: var(--primary);
    background-color: var(--primary-container);
}
.fav-selector-code {
    font-weight: 500;
    color: var(--on-surface);
    font-size: 1rem;
}
.fav-selector-price {
    font-size: 0.9rem;
    color: var(--on-surface-variant);
}
.fav-selector-item:hover .fav-selector-price,
.fav-selector-item:focus .fav-selector-price,
.fav-selector-item:active .fav-selector-price {
    color: var(--on-primary-container);
}
.fav-selector-item:focus .fav-selector-code,
.fav-selector-item:active .fav-selector-code {
    color: var(--on-primary-container);
    font-weight: 700;
}
.fav-selector-body .empty-state {
    text-align: center;
    padding: 2rem;
    color: var(--on-surface-variant);
}
.fav-selector-item.is-hidden {
    display: none;
}
.fav-selector-footer {
    padding: 0.75rem 1.5rem;
    border-top: 1px solid var(--outline);
    display: flex;
    justify-content: flex-end; /* [MODIFIED] Changed from space-between */
    align-items: center;
    flex-shrink: 0;
}
.fav-selector-footer .btn {
    font-size: 0.9rem;
}


/* --- FAVORITE MANAGER MODAL (REDESIGNED) --- */
#favManagerModal .modal-content {
    max-width: 500px;
    width: 95%;
}
.fav-manager-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--outline);
}
.fav-manager-header h3 {
    margin-bottom: 0;
}
.fav-manager-header .btn-icon {
    width: 36px;
    height: 36px;
    font-size: 1.5rem;
    color: var(--on-surface-variant);
}
.fav-manager-body {
    max-height: 60vh;
    overflow-y: auto;
    padding-right: 0.5rem;
}
.fav-manager-item {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 1rem;
    align-items: center;
    padding: 0.75rem 0.5rem;
    border-radius: var(--border-radius-sm);
    transition: background-color var(--transition-speed);
    cursor: pointer;
    border-left: 3px solid transparent;
}
.fav-manager-item:not(:last-child) {
    border-bottom: 1px solid var(--outline);
}
.fav-manager-item:hover {
    background-color: var(--surface-container);
}
.fav-manager-item.is-selected {
    background-color: var(--primary-container);
    border-left-color: var(--primary);
}
.fav-manager-item.is-selected .fav-manager-code {
    color: var(--on-primary-container);
}

.fav-manager-code {
    font-weight: 700;
    color: var(--on-surface);
    word-break: break-all;
}
.fav-manager-price {
    font-size: 0.9rem;
    color: var(--on-primary-container);
    background-color: var(--primary-container);
    padding: 0.25rem 0.75rem;
    border-radius: var(--border-radius-xl);
    font-weight: 700;
    white-space: nowrap;
}
.fav-manager-body .empty-state {
    text-align: center;
    padding: 2rem;
    color: var(--on-surface-variant);
}
#favManagerFooter {
    padding-top: 1rem;
    margin-top: 1rem;
    border-top: 1px solid var(--outline);
    display: flex;
    gap: 0.5rem;
    justify-content: flex-end;
}
#favManagerFooter .btn {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
    font-weight: 500;
    border-radius: var(--border-radius-md);
}
#favManagerFooter .btn[data-act="add-new-fav-form"] {
    margin-right: auto;
}

/* --- [NEW] ROOM DEFAULTS MODAL REDESIGN --- */
#roomDefaultsModal .modal-content {
    max-width: 650px; /* Wider for tabs */
    width: 95%;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    padding: 0; /* Remove padding for edge-to-edge header/footer */
}

.room-defaults-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--outline);
    flex-shrink: 0;
    gap: 0.5rem; /* [ADDED] */
}
.room-defaults-header h3 {
    margin: 0;
    flex-grow: 1; /* [ADDED] */
}
.room-defaults-header .btn-icon {
    color: var(--on-surface-variant);
}
.room-defaults-header .btn-icon:hover {
    color: var(--danger);
    background-color: var(--danger-container);
}

.defaults-nav {
    display: flex;
    flex-wrap: nowrap; /* Prevent wrapping */
    overflow-x: auto; /* Allow horizontal scroll on small screens */
    border-bottom: 1px solid var(--outline);
    padding: 0 1.5rem;
    flex-shrink: 0;
    scrollbar-width: thin;
    scrollbar-color: var(--outline-variant) transparent;
}
.defaults-nav::-webkit-scrollbar { height: 4px; }
.defaults-nav::-webkit-scrollbar-thumb { background-color: var(--outline-variant); border-radius: 2px; }

.defaults-tab {
    padding: 0.8rem 1rem;
    border: none;
    background: none;
    cursor: pointer;
    font-family: var(--font-family);
    font-size: 0.9rem;
    color: var(--on-surface-variant);
    font-weight: 500;
    border-bottom: 3px solid transparent;
    margin-bottom: -1px; /* Overlap border */
    transition: color var(--transition-speed), border-color var(--transition-speed);
    white-space: nowrap;
}
.defaults-tab:hover {
    color: var(--on-surface);
}
.defaults-tab.is-active {
    color: var(--primary);
    font-weight: 700;
    border-bottom-color: var(--primary);
}

.defaults-content-container {
    overflow-y: auto;
    flex-grow: 1;
    padding: 1.5rem;
    background-color: var(--surface-container); /* Slight contrast for content area */
}

.defaults-content {
    display: none; /* Hide inactive tabs */
}
.defaults-content.is-active {
    display: block; /* Show active tab */
}

.defaults-enable-toggle {
    margin-bottom: 1.25rem;
    background-color: var(--surface);
    padding: 0.75rem 1rem;
    border-radius: var(--border-radius-md);
    border: 1px solid var(--outline);
}
.defaults-enable-toggle label {
    display: flex;
    align-items: center;
    cursor: pointer;
    gap: 0.75rem;
    margin: 0;
    color: var(--on-surface);
    font-weight: 500;
    font-size: 0.95rem;
}
.defaults-enable-toggle input[type="checkbox"] {
    accent-color: var(--primary);
    width: 18px;
    height: 18px;
    margin: 0;
}

.defaults-inputs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    background-color: var(--surface);
    padding: 1rem;
    border-radius: var(--border-radius-md);
    border: 1px solid var(--outline);
    transition: opacity 0.3s ease;
}

/* Style for when content is disabled */
.defaults-content:not(.is-enabled-content) .defaults-inputs-grid {
    opacity: 0.5;
    pointer-events: none;
}
.defaults-content:not(.is-enabled-content) .defaults-inputs-grid input {
     background-color: var(--surface-container-high); /* Match disabled input style */
}


.defaults-inputs-grid .form-group {
    margin: 0;
}
.defaults-inputs-grid .form-group label {
    font-size: 0.85rem;
}
.defaults-inputs-grid .form-group input {
    font-size: 1rem;
    padding: 0.65rem 0.75rem;
    background-color: var(--surface-container);
}

/* --- [NEW] Favorites Button in Room Defaults Modal --- */
#roomDefaultsModal .form-group-with-favorites {
    position: relative;
}
#roomDefaultsModal .form-group-with-favorites .form-group {
    position: relative;
    margin: 0;
}
#roomDefaultsModal .btn-show-favs {
    position: absolute;
    right: 1px;
    bottom: 2px; /* Vertically centered */
    width: 40px;
    height: 40px;
    color: var(--on-surface-variant);
    z-index: 5;
}
#roomDefaultsModal .btn-show-favs:hover {
    color: var(--primary);
    background-color: var(--surface-container-high);
}
/* Adjust input padding to make space for button */
#roomDefaultsModal input[data-favorite-type] {
    padding-right: 42px !important;
    padding-left: 0.75rem !important; /* Reset left padding */
}


/* --- [NEW] Force Apply Modal --- */
#forceApplyModal .force-apply-controls {
    display: grid;
    grid-template-columns: 1fr; /* Stack elements initially */
    gap: 1rem;
    background-color: transparent;
    padding: 0.5rem 0 0 0;
    border: none;
}
#forceApplyModal .force-apply-controls .form-group { margin: 0; }
#forceApplyModal .force-apply-controls label { font-size: 0.8rem; }
#forceApplyModal .force-apply-controls input,
#forceApplyModal #forceApplySelectTypeBtn {
    font-size: 1rem; /* Increase size for clarity */
    padding: 0.65rem 0.75rem; /* Match other inputs */
}
#forceApplySelectTypeBtn {
    width: 100%;
    text-align: left;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
#forceApplySelectTypeBtn span {
    flex-grow: 1;
    color: var(--on-primary-container);
}
#forceApplySelectTypeBtn span.placeholder {
    color: var(--on-surface-variant);
    font-style: italic;
}

/* Grid layout for code and price on wider screens */
@media (min-width: 450px) {
    #forceApplyModal .force-apply-controls {
        grid-template-columns: 1fr 1fr; /* Two columns */
    }
     #forceApplyModal .force-apply-controls .full-width-item {
        grid-column: 1 / -1; /* Type selection remains full width */
    }
}
/* Favorites button in force apply */
#forceApplyModal .form-group-with-favorites { position: relative; }
#forceApplyModal .form-group-with-favorites .form-group { position: relative; margin: 0; }
#forceApplyModal .btn-show-favs {
    position: absolute;
    right: 1px;
    bottom: 2px;
    width: 40px;
    height: 40px;
    color: var(--on-surface-variant);
    z-index: 5;
}
#forceApplyModal .btn-show-favs:hover {
    color: var(--primary);
    background-color: var(--surface-container-high);
}
#forceApplyModal input[name="force_apply_code"] {
    padding-right: 42px !important;
}


.modal-actions.room-defaults-actions {
    display: grid; /* Use grid for layout */
    grid-template-columns: 2fr 1fr; /* First column wider */
    gap: 0.75rem; /* Gap between columns and rows */
    margin-top: 0; /* No margin needed, padding is on container */
    padding: 1rem 1.5rem; /* Match header padding */
    border-top: 1px solid var(--outline);
    background-color: var(--surface); /* Match modal background */
    flex-shrink: 0; /* Prevent shrinking */
}

/* Ensure buttons fill their grid area */
.modal-actions.room-defaults-actions .btn-compact {
    width: 100%;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    min-height: 38px;
    justify-content: center; /* Center content in button */
}

.modal-actions.room-defaults-actions .btn-compact i.ph {
    font-size: 1.1em;
    margin-right: 0.25rem;
}

/* Specific placement using grid properties if needed,
   otherwise rely on source order (HTML) */
#roomDefaultsApplyBtn { grid-column: 1; grid-row: 1; }
#roomDefaultsConfirmBtn { grid-column: 2; grid-row: 1; justify-self: end; /* Align right */}
.modal-actions.room-defaults-actions button[data-act="manage-favorites-from-defaults"] { grid-column: 1; grid-row: 2; }
#roomDefaultsCancelBtn { grid-column: 2; grid-row: 2; justify-self: end; /* Align right */}

/* --- End Room Defaults Redesign --- */


/* --- Manage Favs Type Modal --- */
#manageFavsTypeModal .modal-content {
    max-width: 520px; /* Adjust if needed */
}
#manageFavsTypeBody {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Responsive columns */
}
#manageFavsTypeBody .radio-card-content {
    padding: 0.75rem; /* Slightly reduced padding */
}
#manageFavsTypeBody .radio-card-content strong {
    font-size: 0.95rem;
}
#manageFavsTypeBody .radio-card-content small {
    font-size: 0.8rem;
}

/* --- [NEW] Force Apply Type Modal --- */
#forceApplyTypeModal .modal-content {
     max-width: 480px; /* Same as item type modal */
}
#forceApplyTypeModal .radio-card-group {
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
}


@media (max-width: 500px) {
    .modal-actions.room-defaults-actions {
        /* Example: Stack buttons vertically if needed */
        /* flex-direction: column; */
        /* align-items: stretch; */
    }
}
/* --- [NEW] Placeholder Item Styles --- */
.placeholder-item {
    border-left: 5px dashed var(--outline-variant);
    border-top: 3px solid transparent; /* Keep consistent structure */
    background-color: var(--surface-container);
}

.placeholder-item .item-header {
    background-color: transparent;
    border-bottom: 1px solid var(--outline);
    color: var(--on-surface-variant);
}

.placeholder-item .placeholder-label {
    font-weight: 500;
    font-style: italic;
    color: var(--on-surface-variant);
    margin-left: 0.25rem;
}
.placeholder-item .item-header i.ph-placeholder {
    color: var(--primary);
}

.placeholder-content {
    padding: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    text-align: center;
}

.placeholder-dimensions {
    font-size: 1rem;
    color: var(--on-surface);
    line-height: 1.7;
}
.placeholder-dimensions i {
    color: var(--primary);
    margin-right: 0.25rem;
    font-size: 1.1em;
    vertical-align: middle;
}

.btn-select-type {
    width: 100%;
    max-width: 250px;
}
/* Make placeholder look disabled when suspended */
.placeholder-item.is-suspended {
    opacity: 0.5;
    filter: grayscale(80%);
    background-image: repeating-linear-gradient(-45deg, transparent, transparent 5px, rgba(120, 120, 120, 0.1) 5px, rgba(120, 120, 120, 0.1) 10px);
}
.placeholder-item.is-suspended .btn-select-type {
    pointer-events: none; /* Prevent clicking select type when suspended */
}


/* --- [NEW] Dimension Entry Modal --- */
/* (Basic modal styles already cover wrapper and content box) */
#dimensionEntryModal .form-group label {
    font-size: 0.9rem; /* Slightly smaller label */
}
#dimensionEntryModal input {
    font-size: 1.1rem; /* Larger input text */
    padding: 0.75rem 0.8rem;
}


/* --- [NEW] Bulk Dimension Entry Modal Styles --- */
#dimensionRowsContainer {
    scrollbar-width: thin;
    scrollbar-color: var(--outline-variant) transparent;
}
#dimensionRowsContainer::-webkit-scrollbar { height: 4px; width: 4px; }
#dimensionRowsContainer::-webkit-scrollbar-thumb { background-color: var(--outline-variant); border-radius: 2px; }

.dimension-input-row {
    display: grid;
    grid-template-columns: 1fr 1fr auto; /* Width, Height, Remove Button */
    gap: 0.5rem;
    align-items: end; /* Align items to the bottom, useful for button */
}

.dimension-input-row .form-group {
    margin: 0; /* Override default form-group margin */
}

.dimension-input-row input {
    font-size: 1rem; /* Adjust as needed */
    padding: 0.6rem 0.7rem;
    text-align: center;
}

.btn-remove-dimension-row {
    margin-bottom: 2px; /* Align better with inputs */
}

/* Hide remove button for the first row */
#dimensionRowsContainer .dimension-input-row:first-child .btn-remove-dimension-row {
    visibility: hidden;
    pointer-events: none;
}

.btn-add-dimension-row {
    font-size: 0.9rem;
    padding: 0.6rem;
}

/* --- [ADJUSTMENT] Placeholder Dimensions --- */
.placeholder-dimensions.single-line-dims {
    line-height: 1.5; /* Reset line-height */
}
.placeholder-dimensions.single-line-dims br {
    display: none; /* Hide the line break */
}